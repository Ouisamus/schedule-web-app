class Meeting{constructor(e,t,r){this.start=e,this.end=t,this.weekday=r}}class Course{constructor(e){this.name=e,this.meetings=new Array}}class Person{constructor(e,t){this.name=e,this.color=t,this.courses=new Array}}const dayNums=new Map([["M",0],["Tu",1],["W",2],["Th",3],["F",4]]);function getCourseObj(e,t,r){return new Promise(((n,s)=>{let o=`https://app.testudo.umd.edu/soc/${r}/sections?courseIds=${e}`;axios.get(o).then((r=>{let o=new Course(`${e}-${t}`);r.data=r.data.replaceAll(/<img src=.*?>/g,"");const a=document.createElement("coursePage");if(a.innerHTML=r.data.trim(),a.querySelector(`input[value="${t}"]`)){a.querySelector(`input[value="${t}"]`).parentNode.querySelector(".class-days-container").querySelectorAll(".section-day-time-group").forEach((e=>{if(e.querySelector(".section-days")){let t=e.querySelector(".section-days").innerText,r=e.querySelector(".class-start-time").innerText;r=convertClockTimeToMins(r);let n=e.querySelector(".class-end-time").innerText;n=convertClockTimeToMins(n);let s=new Array;for(const e of t)e==e.toUpperCase()?s.push(e):s[s.length-1]+=e;for(const e of s){let t=new Meeting(r,n,dayNums.get(e));o.meetings.push(t)}}})),n(o)}else s("Course not found")})).catch((e=>{console.log("error :("),s(e)}))}))}function convertClockTimeToMins(e){let t,r=[...e.matchAll(/(\d{1,2}):(\d{2})([ap]m)/gm)][0];return r[1]=Number.parseInt(r[1]),r[2]=Number.parseInt(r[2]),t="pm"==r[3]?12==r[1]?12:r[1]+12:12==r[1]?0:r[1],60*t+r[2]}function convertMinsToClockTime(e){if(e>=0&&e<=1439){let t,r=e<720?"am":"pm",n=e%60;return e-n==0?t=12:(t=(e-n)/60,t>12&&(t-=12)),`${t}:${n.toString().padStart(2,"0")}${r}`}}const daysOfWeek=["Monday","Tuesday","Wednesday","Thursday","Friday"],header=document.getElementById("header"),SEMESTER="202401",AUTOCOLOR=!0;let weekday=new Date(Date.now()).getDay()-1;weekday=weekday<=4&&weekday>=0?weekday:0;let colorPalette=["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#FAEC54","#b15928"],numberOfHrs=14;if(header){const e=document.createElementNS("http://www.w3.org/2000/svg","text");drawWeekdayLabel(e,daysOfWeek[weekday],10,"#000"),header.appendChild(e),0==weekday?document.getElementById("previousDayButton").classList.add("grayout"):4==weekday&&document.getElementById("nextDayButton").classList.add("grayout")}const schedule=document.getElementById("schedule");if(schedule){for(let e=1;e<numberOfHrs;e++){let t=document.createElementNS("http://www.w3.org/2000/svg","line");drawHorizLine(t,100/numberOfHrs*e,"#bbb","0.5"),schedule.prepend(t)}const e=document.createElementNS("http://www.w3.org/2000/svg","line");e.setAttribute("id","nowLine"),schedule.appendChild(e),updateCurrentTime();setInterval(updateCurrentTime,2e3);for(let e=1;e<=numberOfHrs;e++){let t=document.createElementNS("http://www.w3.org/2000/svg","text");drawHourLabel(t,e+8,3,100/numberOfHrs*e-1,"#000"),schedule.appendChild(t)}let t=document.createElementNS("http://www.w3.org/2000/svg","line");drawVertLine(t,10,"#bbb","0.5"),schedule.prepend(t);const r=document.querySelector("#courses");if(r){let e=new Array,t=new Array;e.push(new Person("Ryan","#9b59b6"),new Person("Keys","#388fc7"),new Person("Willa","#8FAE53"),new Person("Alphonse","#2ECC71"),new Person("Kristin","#BA88F8"),new Person("Ian","#37DFBE"),new Person("Adib","#BE2F96"),new Person("Eitan","#5384EC"),new Person("Jack","#8721B2"),new Person("Jacob","#DB7093"),new Person("Bryan","#1F8B4C"),new Person("Louisa","#F1C40F")),t.push([["ENGL101","1002"],["THET285","0102"],["ECON230","0101"],["ECON306","0202"],["PLCY213","0201"]],[["CMSC132","0202"],["BSCI103","1107"],["MATH141","0523"],["COMM107","9920"]],[["CMSC132","0202"],["ARHU275","0101"],["MATH240","0122"],["ENGL101","1101"],["JOUR284","0101"]],[["CHEM237","5355"],["PHYS161","0306"],["BSCI223","2401"],["ENGL272","0201"],["BSCI223","2401"],["CHEM237","5355"],["MUSC229U","0101"]],[["PHYS265","0101"],["PHYS274","0101"],["PHYS275","0201"],["ENGL272","0201"],["GEMS104","0111"],["GEMS102","0101"]],[["BIOE121","0104"],["MATH246H","0201"],["BIOE120","0201"],["BIOE241","0102"],["ENES100","0401"],["GEMS104","0101"],["GEMS102","0101"]],[["BIOE121","0102"],["MATH461","0112"],["PHYS161","0303"],["BIOE241","0102"],["ENES100","0402"],["BIOE120","0102"],["MUSC229U","0101"]],[["MATH141","0131"],["ENES102","0701"],["ENAE202","0103"],["PHYS161","0305"],["COMM107","6801"]],[["BMGT110S","0101"],["THET110","0107"],["CMSC132","0205"],["THET380","5501"],["ENGL101S","1309"]],[["STAT100","0131"],["ENGL265","0201"],["ARTT110","0401"],["ENGL272","0201"],["BSCI103","1109"]],[["CMSC132","0201"],["MATH241","0312"],["MATH240","0123"],["NFSC220","0101"],["MUSC229U","0101"]],[["CMSC132","0103"],["COMM107","6801"],["MATH461","0133"],["PSYC100","0503"],["THET377","5501"]]),loadAllCourseLists(t).then((t=>{t.map(((t,r)=>{t.map((t=>{e[r].courses.push(t)}))})),e.sort(((e,t)=>e.name.localeCompare(t.name))),drawCourses(r,e)})),document.getElementById("previousDayButton").addEventListener("click",(function(){previousDay(r,e)})),document.getElementById("nextDayButton").addEventListener("click",(function(){nextDay(r,e)})),r.addEventListener("click",(function(e){let t=e.target;console.log(`${t.getAttribute("data-person")}: ${t.getAttribute("data-course")}`)}))}}function loadAllCourseLists(e){let t=e.map((e=>loadCourseList(e)));return Promise.all(t)}function loadCourseList(e){let t=e.map((e=>getCourseObj(e[0],e[1],"202401")));return Promise.all(t)}function updateCurrentTime(){const e=document.getElementById("nowLine");let t=new Date(Date.now()),r=t.getDay()-1==weekday?1:.3;t=60*t.getHours()+t.getMinutes(),t>=480&&t<=1200&&drawHorizLine(e,100/(60*numberOfHrs)*(t-480),"#f00","0.5",r)}function drawHorizLine(e,t,r,n,s){e.setAttribute("x1","0"),e.setAttribute("x2","100%"),e.setAttribute("y1",`${t}%`),e.setAttribute("y2",`${t}%`),e.setAttribute("stroke",r),e.setAttribute("stroke-width",n),s&&e.setAttribute("stroke-opacity",s)}function drawVertLine(e,t,r,n){e.setAttribute("x1",t),e.setAttribute("x2",t),e.setAttribute("y1","0"),e.setAttribute("y2","100%"),e.setAttribute("stroke",r),e.setAttribute("stroke-width",n)}function drawHourLabel(e,t,r,n,s){textNode=t<=12?document.createTextNode(`${t}:00`):document.createTextNode(t-12+":00"),e.appendChild(textNode),e.setAttribute("font-size",r),e.setAttribute("font-family","helvetica"),e.setAttribute("text-anchor","end"),e.setAttribute("x",3*r),e.setAttribute("y",`${n}%`),e.setAttribute("fill",s)}function drawWeekdayLabel(e,t,r,n){textNode=document.createTextNode(t),e.appendChild(textNode),e.setAttribute("font-size",r),e.setAttribute("font-family","helvetica"),e.setAttribute("text-anchor","middle"),e.setAttribute("dominant-baseline","central"),e.setAttribute("x","50%"),e.setAttribute("y","50%"),e.setAttribute("fill",n),e.setAttribute("id","weekdayLabel")}function drawMeeting(e,t,r,n,s,o,a){let i=s.start,u=s.end,d=a?colorPalette[t%colorPalette.length]:n.color;e.setAttribute("x",100/r*t+"%"),e.setAttribute("y",100/(60*numberOfHrs)*(i-480)+"%"),e.setAttribute("width",100/r+"%"),e.setAttribute("height",100/(60*numberOfHrs)*(u-i)+"%"),e.setAttribute("fill",d),e.setAttribute("rx",2),e.classList.add("meeting"),e.setAttribute("data-person",n.name),e.setAttribute("data-course",o)}function drawCourses(e,t){let r=t.length;if(r>0){for(;e.firstChild;)e.removeChild(e.lastChild);t.forEach(((t,n)=>{t.courses.forEach((s=>{drawOneCourse(e,s,t,n,r)}))}))}}function drawOneCourse(e,t,r,n,s){t.meetings.forEach((o=>{if(weekday==o.weekday){let a=document.createElementNS("http://www.w3.org/2000/svg","rect");drawMeeting(a,n,s,r,o,t.name,AUTOCOLOR),e.appendChild(a)}}))}function previousDay(e,t){if(weekday>0){weekday--,drawCourses(e,t),document.getElementById("weekdayLabel").firstChild.nodeValue=daysOfWeek[weekday],updateCurrentTime();let r=document.getElementById("previousDayButton"),n=document.getElementById("nextDayButton");n.classList.contains("grayout")?n.classList.remove("grayout"):0==weekday&&r.classList.add("grayout")}}function nextDay(e,t){if(weekday<4){weekday++,drawCourses(e,t),document.getElementById("weekdayLabel").firstChild.nodeValue=daysOfWeek[weekday],updateCurrentTime();let r=document.getElementById("previousDayButton"),n=document.getElementById("nextDayButton");r.classList.contains("grayout")?r.classList.remove("grayout"):4==weekday&&n.classList.add("grayout")}}